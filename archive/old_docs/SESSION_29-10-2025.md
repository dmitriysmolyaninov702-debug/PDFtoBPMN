# –ò—Å—Ç–æ—Ä–∏—è —Ä–∞–±–æ—Ç—ã: 29 –æ–∫—Ç—è–±—Ä—è 2025

## üìã –ö—Ä–∞—Ç–∫–æ–µ —Ä–µ–∑—é–º–µ —Å–µ—Å—Å–∏–∏

**–ü—Ä–æ–µ–∫—Ç:** BPMN Process Automation - PDF to Context Pipeline  
**–î–∞—Ç–∞:** 29 –æ–∫—Ç—è–±—Ä—è 2025  
**–î–ª–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å:** ~4 —á–∞—Å–∞  
**–û—Å–Ω–æ–≤–Ω—ã–µ –¥–æ—Å—Ç–∏–∂–µ–Ω–∏—è:**
- ‚úÖ –ú–∏–≥—Ä–∞—Ü–∏—è –ø—Ä–æ–µ–∫—Ç–∞ –∏–∑ Windows FS –≤ Linux FS (2-5x –ø—Ä–∏—Ä–æ—Å—Ç –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏)
- ‚úÖ –†–µ—à–µ–Ω–∞ –ø—Ä–æ–±–ª–µ–º–∞ RTX 5080 (Blackwell, sm_120) —Å PyTorch
- ‚úÖ –†–µ–∞–ª–∏–∑–æ–≤–∞–Ω –∫–æ–º–ø–æ–Ω–µ–Ω—Ç StructurePreserver
- ‚úÖ –ù–∞—Å—Ç—Ä–æ–µ–Ω DeepSeek-OCR –º–∏–∫—Ä–æ—Å–µ—Ä–≤–∏—Å (–±–µ–∑ vLLM, —á–µ—Ä–µ–∑ HuggingFace API)
- ‚úÖ –ü—Ä–æ–µ–∫—Ç —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∏—Ä–æ–≤–∞–Ω —Å GitHub

---

## üéØ –ö–æ–Ω—Ç–µ–∫—Å—Ç –ø—Ä–æ–µ–∫—Ç–∞

### –¶–µ–ª—å –ø—Ä–æ–µ–∫—Ç–∞
–ê–≤—Ç–æ–º–∞—Ç–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ PDF –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤ (—Ä–µ–≥–ª–∞–º–µ–Ω—Ç—ã, –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏, BPMN —Å—Ö–µ–º—ã) –¥–ª—è –ø–æ—Å—Ç—Ä–æ–µ–Ω–∏—è –±–∏–∑–Ω–µ—Å-–ø—Ä–æ—Ü–µ—Å—Å–æ–≤ –≤ —Ñ–æ—Ä–º–∞—Ç–µ Markdown, —Å–æ–≤–º–µ—Å—Ç–∏–º—ã—Ö —Å Camunda Modeler.

### –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ Pipeline
```
PDF ‚Üí NativeExtractor ‚Üí StructurePreserver ‚Üí IRBuilder ‚Üí MarkdownFormatter ‚Üí MD
                              ‚Üì
                         OCR Service
                         (DeepSeek-OCR)
```

### –¢–µ–∫—É—â–∏–π —Å—Ç–µ–∫
- **Python 3.10**
- **PyTorch 2.9.0+cu128** (–∫—Ä–∏—Ç–∏—á–Ω–æ –¥–ª—è RTX 5080!)
- **DeepSeek-OCR** (HuggingFace Transformers API)
- **FastAPI** (OCR –º–∏–∫—Ä–æ—Å–µ—Ä–≤–∏—Å)
- **PyMuPDF** (–∏–∑–≤–ª–µ—á–µ–Ω–∏–µ –∏–∑ PDF)
- **GPU:** NVIDIA RTX 5080 (Blackwell, 16GB VRAM)

---

## üìÖ –•—Ä–æ–Ω–æ–ª–æ–≥–∏—è —Ä–∞–±–æ—Ç—ã

### 1. –ò—Å—Å–ª–µ–¥–æ–≤–∞–Ω–∏–µ StructurePreserver (–Ω–∞—á–∞–ª–æ)

**–ó–∞–¥–∞—á–∞:** –ü—Ä–æ–≤–µ—Ä–∏—Ç—å, —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω –ª–∏ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç `StructurePreserver`, –æ–ø–∏—Å–∞–Ω–Ω—ã–π –≤ –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–µ.

**–†–µ–∑—É–ª—å—Ç–∞—Ç:** –ö–æ–º–ø–æ–Ω–µ–Ω—Ç –æ–ø–∏—Å–∞–Ω –≤ `docs/Architecture.md`, –Ω–æ –Ω–µ —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω –≤ –∫–æ–¥–µ.

**–†–µ—à–µ–Ω–∏–µ:** –°–æ–≥–ª–∞—Å–æ–≤–∞–Ω–æ —Å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–º - —Ä–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å `StructurePreserver` –∏ –ø–æ–ª–Ω—ã–π pipeline.

---

### 2. –†–µ–∞–ª–∏–∑–∞—Ü–∏—è StructurePreserver

**–°–æ–∑–¥–∞–Ω —Ñ–∞–π–ª:** `pdf_to_context/core/structure_preserver.py`

**–§—É–Ω–∫—Ü–∏–æ–Ω–∞–ª:**
- –í—Å—Ç—Ä–∞–∏–≤–∞–Ω–∏–µ OCR —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤ –≤ —Å—Ç—Ä—É–∫—Ç—É—Ä—É –¥–æ–∫—É–º–µ–Ω—Ç–∞ –Ω–∞ –æ—Å–Ω–æ–≤–µ bounding box –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç
- –§–∏–ª—å—Ç—Ä–∞—Ü–∏—è –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π –ø–æ –º–∏–Ω–∏–º–∞–ª—å–Ω–æ–π –ø–ª–æ—â–∞–¥–∏
- –û–±—Ä–∞–±–æ—Ç–∫–∞ –∫–∞–∫ `ImageBlock`, —Ç–∞–∫ –∏ `DrawingBlock` (–≤–µ–∫—Ç–æ—Ä–Ω–∞—è –≥—Ä–∞—Ñ–∏–∫–∞)
- –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –æ–±—Ä–∞–±–æ—Ç–∫–∏ (total_images, ocr_processed, ocr_skipped, ocr_errors)

**–ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è:**
- –ú–æ–¥–∏—Ñ–∏—Ü–∏—Ä–æ–≤–∞–Ω `pdf_to_context/pipeline.py` –¥–ª—è –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è StructurePreserver
- –î–æ–±–∞–≤–ª–µ–Ω —Ñ–ª–∞–≥ `needs_ocr` –≤ `ImageBlock` –∏ `DrawingBlock` (`pdf_to_context/models/data_models.py`)
- –û–±–Ω–æ–≤–ª–µ–Ω `NativeExtractor` –¥–ª—è —Ä–µ–Ω–¥–µ—Ä–∏–Ω–≥–∞ –≤–µ–∫—Ç–æ—Ä–Ω–æ–π –≥—Ä–∞—Ñ–∏–∫–∏ –≤ —Ä–∞—Å—Ç—Ä–æ–≤—ã–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è

---

### 3. –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ —Å OCR –Ω–∞ –¥–æ–∫—É–º–µ–Ω—Ç–µ –ö–î-–°–¢-161-01

**–ö–æ–º–∞–Ω–¥–∞:** `python test_full_pipeline_with_ocr.py`

**–ü—Ä–æ–±–ª–µ–º–∞:** OCR —Å–µ—Ä–≤–∏—Å –Ω–µ –∑–∞–ø—É—â–µ–Ω.

**–†–µ—à–µ–Ω–∏–µ:** –ü—Ä–æ–≤–µ—Ä–∏–ª–∏ –ª–æ–∫–∞–ª—å–Ω—É—é —É—Å—Ç–∞–Ω–æ–≤–∫—É DeepSeek-OCR.

---

### 4. –ù–∞—Å—Ç—Ä–æ–π–∫–∞ DeepSeek-OCR (–ø–µ—Ä–≤–∞—è –ø–æ–ø—ã—Ç–∫–∞)

**–ü—Ä–æ–±–ª–µ–º–∞ 1:** –°–∫—Ä–∏–ø—Ç—ã DeepSeek-OCR –∏—Å–ø–æ–ª—å–∑—É—é—Ç vLLM —Å —É—Å—Ç–∞—Ä–µ–≤—à–∏–º API.

**–ü—Ä–æ–±–ª–µ–º–∞ 2:** vLLM 0.11.0 –∏–º–µ–µ—Ç breaking changes:
- `SamplingMetadata` –ø–µ—Ä–µ–º–µ—â–µ–Ω –∏–∑ `vllm.model_executor` –≤ `vllm.v1.sample.metadata`
- –¢—Ä–µ–±—É–µ—Ç—Å—è flash-attention, –∫–æ—Ç–æ—Ä—ã–π —Å–ª–æ–∂–Ω–æ —Å–æ–±–∏—Ä–∞–µ—Ç—Å—è

**–ü–æ–ø—ã—Ç–∫–∞ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è:**
- –û–±–Ω–æ–≤–ª–µ–Ω—ã –∏–º–ø–æ—Ä—Ç—ã –≤ `deepseek_ocr.py`
- –£—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω—ã –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏: `wheel`, `flash-attn`
- –î–æ–±–∞–≤–ª–µ–Ω—ã fallback –¥–ª—è flash_attn

**–†–µ–∑—É–ª—å—Ç–∞—Ç:** –ú–Ω–æ–∂–µ—Å—Ç–≤–µ–Ω–Ω—ã–µ –æ—à–∏–±–∫–∏ —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç–∏ vLLM.

**–†–µ—à–µ–Ω–∏–µ:** –û—Ç–∫–∞–∑–∞–ª–∏—Å—å –æ—Ç vLLM. –†–∞–∑—Ä–∞–±–æ—Ç–∞–ª–∏ —Å–æ–±—Å—Ç–≤–µ–Ω–Ω—ã–π FastAPI –º–∏–∫—Ä–æ—Å–µ—Ä–≤–∏—Å —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º HuggingFace Transformers API –Ω–∞–ø—Ä—è–º—É—é.

---

### 5. –°–æ–∑–¥–∞–Ω–∏–µ FastAPI –º–∏–∫—Ä–æ—Å–µ—Ä–≤–∏—Å–∞ DeepSeek-OCR

**–§–∞–π–ª:** `pdf_to_context/ocr_service/app.py`

**–û—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏:**
- **–ë–µ–∑ vLLM** - –∏—Å–ø–æ–ª—å–∑—É–µ—Ç `model.infer()` –∏–∑ DeepSeek-OCR –Ω–∞–ø—Ä—è–º—É—é
- Lazy loading –º–æ–¥–µ–ª–∏ (–∑–∞–≥—Ä—É–∂–∞–µ—Ç—Å—è –ø—Ä–∏ –ø–µ—Ä–≤–æ–º –∑–∞–ø—Ä–æ—Å–µ)
- Endpoints:
  - `GET /` - –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ —Å–µ—Ä–≤–∏—Å–µ
  - `GET /health` - health check
  - `POST /ocr/figure` - OCR –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π (multipart/form-data)
- Structured output: —Å–ø–∏—Å–æ–∫ `OCRBlock` + markdown
- –ò—Å–ø–æ–ª—å–∑—É–µ—Ç `_attn_implementation='eager'` –¥–ª—è —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç–∏

**–ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å OCRClient:**
- –û–±–Ω–æ–≤–ª–µ–Ω `pdf_to_context/extractors/ocr_client.py`
- –ú–µ—Ç–æ–¥ `ocr_image` —Ç–µ–ø–µ—Ä—å –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç `multipart/form-data`
- –ü–∞—Ä—Å–∏–Ω–≥ –Ω–æ–≤–æ–π —Å—Ç—Ä—É–∫—Ç—É—Ä—ã JSON –æ—Ç–≤–µ—Ç–∞

---

### 6. –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –≤–µ—Ä—Å–∏–π transformers –∏ tokenizers

**–ü—Ä–æ–±–ª–µ–º–∞:** –û—à–∏–±–∫–∏ –∑–∞–≥—Ä—É–∑–∫–∏ –º–æ–¥–µ–ª–∏ –∏ tokenizer:
```
ImportError: cannot import name 'LlamaFlashAttention2'
Exception: data did not match any variant of untagged enum ModelWrapper
```

**–ü—Ä–∏—á–∏–Ω–∞:** –ù–µ—Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç—å –≤–µ—Ä—Å–∏–π `transformers` –∏ `tokenizers`.

**–†–µ—à–µ–Ω–∏–µ:**
- –û—Ç–∫–∞—Ç–∏–ª–∏ `transformers` –Ω–∞ `4.46.3` (–∏–∑ –æ—Ñ–∏—Ü–∏–∞–ª—å–Ω–æ–≥–æ requirements.txt)
- –û—Ç–∫–∞—Ç–∏–ª–∏ `tokenizers` –Ω–∞ `0.20.3`
- –£–±–µ–¥–∏–ª–∏—Å—å, —á—Ç–æ –∏—Å–ø–æ–ª—å–∑—É–µ–º –æ—Ñ–∏—Ü–∏–∞–ª—å–Ω—ã–µ –≤–µ—Ä—Å–∏–∏ –∏–∑ DeepSeek-OCR repo

**–ö–æ–º–∞–Ω–¥—ã:**
```bash
pip install transformers==4.46.3 tokenizers==0.20.3
```

---

### 7. –ú–∏–≥—Ä–∞—Ü–∏—è –ø—Ä–æ–µ–∫—Ç–∞ –≤ Linux FS

**–ü—Ä–æ–±–ª–µ–º–∞:** –ú–µ–¥–ª–µ–Ω–Ω–∞—è —Ä–∞–±–æ—Ç–∞ –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ –º–æ–¥–µ–ª–µ–π –∏ –æ–±—Ä–∞–±–æ—Ç–∫–µ —Ñ–∞–π–ª–æ–≤ –≤ Windows FS (`/mnt/c/...`).

**–ü—Ä–∏—á–∏–Ω–∞:** Windows FS —á–µ—Ä–µ–∑ WSL2 –º–æ–Ω—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –∏–º–µ–µ—Ç –≤—ã—Å–æ–∫—É—é –ª–∞—Ç–µ–Ω—Ç–Ω–æ—Å—Ç—å I/O (–≤ 2-5 —Ä–∞–∑ –º–µ–¥–ª–µ–Ω–Ω–µ–µ).

**–†–µ—à–µ–Ω–∏–µ:**
- –ü–µ—Ä–µ–Ω–µ—Å–ª–∏ –≤–µ—Å—å –ø—Ä–æ–µ–∫—Ç –≤ Linux FS: `~/Obligations` (`/home/budnik_an/Obligations`)
- –ü–µ—Ä–µ—Å–æ–∑–¥–∞–ª–∏ venv –≤ Linux FS
- –£—Å—Ç–∞–Ω–æ–≤–∏–ª–∏ –≤—Å–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –∑–∞–Ω–æ–≤–æ (PyTorch, transformers, –ø—Ä–æ–µ–∫—Ç–Ω—ã–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏)

**–ö–æ–º–∞–Ω–¥—ã:**
```bash
cd ~
cp -r /mnt/c/Users/Budnik_AN/Obligations ./Obligations
cd Obligations/DeepSeek-OCR
python3 -m venv venv
source venv/bin/activate
pip install torch torchvision torchaudio --index-url https://download.pytorch.org/whl/cu118
pip install -r requirements.txt
```

**–î–æ—Å—Ç—É–ø –∏–∑ Windows:**
- –ü—É—Ç—å: `\\wsl$\Ubuntu\home\budnik_an\Obligations`
- –ò–ª–∏ —á–µ—Ä–µ–∑ Explorer: Network ‚Üí Add Network Location ‚Üí `\\wsl$\Ubuntu`

**–†–µ–∑—É–ª—å—Ç–∞—Ç:**
- ‚úÖ –ó–∞–≥—Ä—É–∑–∫–∞ DeepSeek-OCR: **2-5x –±—ã—Å—Ç—Ä–µ–µ**
- ‚úÖ –û–±—Ä–∞–±–æ—Ç–∫–∞ PDF: **1.5-3x –±—ã—Å—Ç—Ä–µ–µ**
- ‚úÖ –ß—Ç–µ–Ω–∏–µ/–∑–∞–ø–∏—Å—å —Ñ–∞–π–ª–æ–≤: **–∑–Ω–∞—á–∏—Ç–µ–ª—å–Ω–æ –±—ã—Å—Ç—Ä–µ–µ**

---

### 8. –ö–†–ò–¢–ò–ß–ï–°–ö–ê–Ø –ü–†–û–ë–õ–ï–ú–ê: RTX 5080 –Ω–µ —Ä–∞–±–æ—Ç–∞–µ—Ç —Å PyTorch 2.7.1

**–û—à–∏–±–∫–∞ –ø—Ä–∏ –∑–∞–ø—É—Å–∫–µ OCR —Å–µ—Ä–≤–∏—Å–∞:**
```
RuntimeError: CUDA error: no kernel image is available for execution on the device
NVIDIA GeForce RTX 5080 with CUDA capability sm_120 is not compatible with the current PyTorch installation.
The current PyTorch install supports CUDA capabilities sm_50 sm_60 sm_70 sm_75 sm_80 sm_86 sm_37 sm_90.
```

**–ü—Ä–∏—á–∏–Ω–∞:**
- RTX 5080 –∏—Å–ø–æ–ª—å–∑—É–µ—Ç –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—É **Blackwell (compute capability sm_120)**
- PyTorch 2.7.1+cu118 –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç —Ç–æ–ª—å–∫–æ –¥–æ **sm_90 (Ada Lovelace / H100)**
- PyTorch 2.7.1 –±—ã–ª —Å–æ–±—Ä–∞–Ω –ø–æ–¥ CUDA 11.8

**–î–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞:**
```bash
python3 -c "import torch; print(torch.__version__); print(torch.cuda.is_available())"
# PyTorch: 2.7.1+cu118
# CUDA available: True (–Ω–æ –Ω–µ —Ä–∞–±–æ—Ç–∞–µ—Ç —Å RTX 5080!)
```

**–†–µ—à–µ–Ω–∏–µ:**
–£—Å—Ç–∞–Ω–æ–≤–∏–ª–∏ **PyTorch 2.9.0+cu128** —Å –ø–æ–¥–¥–µ—Ä–∂–∫–æ–π Blackwell:

```bash
cd ~/Obligations/DeepSeek-OCR
source venv/bin/activate

# –£–¥–∞–ª–∏—Ç—å —Å—Ç–∞—Ä—É—é –≤–µ—Ä—Å–∏—é
pip uninstall -y torch torchvision torchaudio

# –£—Å—Ç–∞–Ω–æ–≤–∏—Ç—å PyTorch 2.9.0 + CUDA 12.8
pip install torch torchvision torchaudio --index-url https://download.pytorch.org/whl/cu128
```

**–ü—Ä–æ–≤–µ—Ä–∫–∞ –ø–æ—Å–ª–µ —É—Å—Ç–∞–Ω–æ–≤–∫–∏:**
```bash
python3 -c "import torch; print(f'PyTorch: {torch.__version__}'); print(f'CUDA available: {torch.cuda.is_available()}'); print(f'GPU: {torch.cuda.get_device_name(0)}')"
```

**–û–∂–∏–¥–∞–µ–º—ã–π –≤—ã–≤–æ–¥:**
```
PyTorch: 2.9.0+cu128
CUDA available: True
GPU: NVIDIA GeForce RTX 5080
```

**–†–µ–∑—É–ª—å—Ç–∞—Ç:**
‚úÖ RTX 5080 —É—Å–ø–µ—à–Ω–æ –æ–±–Ω–∞—Ä—É–∂–µ–Ω–∞ –∏ —Ä–∞–±–æ—Ç–∞–µ—Ç!
‚úÖ DeepSeek-OCR —Å–µ—Ä–≤–∏—Å –∑–∞–≥—Ä—É–∂–∞–µ—Ç—Å—è –Ω–∞ GPU

**–°–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç—å:**
- ‚úÖ PyTorch 2.9.0+: –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç sm_120 (Blackwell)
- ‚úÖ PyTorch 2.8.0+: —á–∞—Å—Ç–∏—á–Ω–∞—è –ø–æ–¥–¥–µ—Ä–∂–∫–∞ Blackwell
- ‚ùå PyTorch 2.7.x –∏ —Å—Ç–∞—Ä—à–µ: –ù–ï –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞—é—Ç sm_120

---

### 9. –£—Å–ø–µ—à–Ω—ã–π –∑–∞–ø—É—Å–∫ DeepSeek-OCR –º–∏–∫—Ä–æ—Å–µ—Ä–≤–∏—Å–∞

**–ö–æ–º–∞–Ω–¥–∞:**
```bash
cd ~/Obligations
source DeepSeek-OCR/venv/bin/activate
python -m uvicorn pdf_to_context.ocr_service.app:app --host 0.0.0.0 --port 8000 --log-level info
```

**–í—ã–≤–æ–¥:**
```
INFO:     Started server process [60822]
INFO:     Waiting for application startup.
INFO:pdf_to_context.ocr_service.app:üîÑ –ó–∞–≥—Ä—É–∑–∫–∞ DeepSeek-OCR...
INFO:pdf_to_context.ocr_service.app:   –ó–∞–≥—Ä—É–∑–∫–∞ —Ç–æ–∫–µ–Ω–∏–∑–∞—Ç–æ—Ä–∞...
INFO:pdf_to_context.ocr_service.app:   –ó–∞–≥—Ä—É–∑–∫–∞ –º–æ–¥–µ–ª–∏ (—ç—Ç–æ –º–æ–∂–µ—Ç –∑–∞–Ω—è—Ç—å –≤—Ä–µ–º—è –ø—Ä–∏ –ø–µ—Ä–≤–æ–º –∑–∞–ø—É—Å–∫–µ)...
You are using a model of type deepseek_vl_v2 to instantiate a model of type DeepseekOCR. This is not supported for all configurations of models and can yield errors.
Some weights of DeepseekOCRForCausalLM were not initialized from the model checkpoint at deepseek-ai/DeepSeek-OCR and are newly initialized: ['model.vision_model.embeddings.position_ids']
You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.
INFO:pdf_to_context.ocr_service.app:‚úÖ DeepSeek-OCR —É—Å–ø–µ—à–Ω–æ –∑–∞–≥—Ä—É–∂–µ–Ω!
INFO:     Application startup complete.
INFO:     Uvicorn running on http://0.0.0.0:8000 (Press CTRL+C to quit)
```

**Health check:**
```bash
curl http://localhost:8000/health | python3 -m json.tool
```

**–û—Ç–≤–µ—Ç:**
```json
{
    "status": "healthy",
    "model_loaded": true,
    "cuda_available": true,
    "cuda_device": "NVIDIA GeForce RTX 5080"
}
```

‚úÖ **–°–µ—Ä–≤–∏—Å —Ä–∞–±–æ—Ç–∞–µ—Ç!**

---

### 10. –ü–æ–ª–Ω—ã–π —Ç–µ—Å—Ç pipeline —Å OCR

**–ö–æ–º–∞–Ω–¥–∞:**
```bash
cd ~/Obligations
source DeepSeek-OCR/venv/bin/activate
python test_vector_ocr_debug.py
```

**–†–µ–∑—É–ª—å—Ç–∞—Ç—ã —Ç–µ—Å—Ç–∞:**
- **–î–æ–∫—É–º–µ–Ω—Ç:** –ö–î-–°–¢-161-01 (–≠—Ç–∞–ª–æ–Ω –¥–ª—è –æ–∑–Ω–∞–∫–æ–º–ª–µ–Ω–∏—è).pdf
- **–í—Å–µ–≥–æ —Å—Ç—Ä–∞–Ω–∏—Ü:** 54
- **–†–µ–∂–∏–º:** Native + OCR
- **–ü–∞—Ä–∞–º–µ—Ç—Ä—ã:**
  - `enable_ocr = True`
  - `ocr_vector_graphics = True`
  - `vector_render_dpi = 300`
  - `min_image_area = 1000` (—Å–Ω–∏–∂–µ–Ω —Å 5000)

**–°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –æ–±—Ä–∞–±–æ—Ç–∫–∏:**
```
–í—Å–µ–≥–æ —Å—Ç—Ä–∞–Ω–∏—Ü: 54

–ì—Ä–∞—Ñ–∏–∫–∞:
- –ù–∞–π–¥–µ–Ω–æ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π: 0
- –û–±—Ä–∞–±–æ—Ç–∞–Ω–æ OCR: 0
- –ü—Ä–æ–ø—É—â–µ–Ω–æ (–º–∞–ª–µ–Ω—å–∫–∏–µ): 79
- –û—à–∏–±–æ–∫ OCR: 45

–ë–ª–æ–∫–æ–≤ –≤ IR: 6558
- Native: 6558
- OCR: 0

–ü–æ —Ç–∏–ø–∞–º:
- heading: 300
- paragraph: 455
- vector: 5764
- table: 39
```

**–ü—Ä–æ–±–ª–µ–º–∞ –æ–±–Ω–∞—Ä—É–∂–µ–Ω–∞:**
–û—Ç–¥–µ–ª—å–Ω—ã–µ –≤–µ–∫—Ç–æ—Ä–Ω—ã–µ —ç–ª–µ–º–µ–Ω—Ç—ã BPMN –¥–∏–∞–≥—Ä–∞–º–º —Å–ª–∏—à–∫–æ–º –º–∞–ª—ã –¥–ª—è —Ä–µ–Ω–¥–µ—Ä–∏–Ω–≥–∞:
- –õ–∏–Ω–∏–∏: 2-4 px¬≤
- –°—Ç—Ä–µ–ª–∫–∏: 64-151 px¬≤
- –§–∏–≥—É—Ä—ã: 122-302 px¬≤
- **–í—Å–µ < 1000 px¬≤** ‚Üí –Ω–µ —Ä–µ–Ω–¥–µ—Ä—è—Ç—Å—è ‚Üí OCR –Ω–µ –ø—Ä–∏–º–µ–Ω—è–µ—Ç—Å—è

**–ê–Ω–∞–ª–∏–∑ —Å—Ç—Ä–∞–Ω–∏—Ü—ã 54 (BPMN –¥–∏–∞–≥—Ä–∞–º–º—ã):**
```
–í–µ–∫—Ç–æ—Ä–Ω—ã—Ö placeholder'–æ–≤: 10

‚úÖ –ù–ê–ô–î–ï–ù–´ –∫–ª—é—á–µ–≤—ã–µ —Å–ª–æ–≤–∞ –∏–∑ BPMN (1/8):
   ‚úì '—à–ª—é–∑' - —à–ª—é–∑ –≤ –∑–∞–≥–æ–ª–æ–≤–∫–µ

‚ùå –ù–ï –ù–ê–ô–î–ï–ù–´ (7/8):
   ‚úó '–ü—Ä–æ—Ü–µ—Å—Å' - –Ω–∞–∑–≤–∞–Ω–∏–µ –ø—Ä–æ—Ü–µ—Å—Å–∞ –≤ –¥–∏–∞–≥—Ä–∞–º–º–µ
   ‚úó '–°–æ–±—ã—Ç–∏–µ' - —Å–æ–±—ã—Ç–∏—è –≤ –¥–∏–∞–≥—Ä–∞–º–º–µ
   ‚úó '–ü—Ä–æ—Ü–µ—Å—Å 1' - –∫–æ–Ω–∫—Ä–µ—Ç–Ω—ã–π —ç–ª–µ–º–µ–Ω—Ç –¥–∏–∞–≥—Ä–∞–º–º—ã
   ...

–ü—Ä–æ—Ü–µ–Ω—Ç —É—Å–ø–µ—Ö–∞: 12.5%
```

**–í—ã–≤–æ–¥:**
- ‚úÖ Pipeline —Ä–∞–±–æ—Ç–∞–µ—Ç
- ‚úÖ OCR —Å–µ—Ä–≤–∏—Å –Ω–∞ RTX 5080 —Ä–∞–±–æ—Ç–∞–µ—Ç –æ—Ç–ª–∏—á–Ω–æ
- ‚ùå –¢–µ–∫—Å—Ç –≤–Ω—É—Ç—Ä–∏ BPMN –¥–∏–∞–≥—Ä–∞–º–º **–Ω–µ —Ä–∞—Å–ø–æ–∑–Ω–∞–µ—Ç—Å—è**

**–ü—Ä–∏—á–∏–Ω–∞:**
–¢–µ–∫—Å—Ç –≤ BPMN –¥–∏–∞–≥—Ä–∞–º–º–∞—Ö –Ω–∞—Ö–æ–¥–∏—Ç—Å—è –ª–∏–±–æ –≤ native text layer PDF, –ª–∏–±–æ —è–≤–ª—è–µ—Ç—Å—è —á–∞—Å—Ç—å—é –≤–µ–∫—Ç–æ—Ä–Ω—ã—Ö –ø—É—Ç–µ–π. –û—Ç–¥–µ–ª—å–Ω—ã–µ –≤–µ–∫—Ç–æ—Ä–Ω—ã–µ —ç–ª–µ–º–µ–Ω—Ç—ã —Å–ª–∏—à–∫–æ–º –º–∞–ª—ã –¥–ª—è OCR.

---

### 11. –°–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è —Å GitHub

**–°–æ–∑–¥–∞–Ω .gitignore:**
```gitignore
# Python
__pycache__/
*.pyc
venv/

# DeepSeek-OCR
DeepSeek-OCR/
.cache/

# Output
output/
*.log
show_results.html
test_*.py
```

**–î–æ–±–∞–≤–ª–µ–Ω—ã —Ñ–∞–π–ª—ã:**
```bash
git add .gitignore
git add Changelog.md docs/DeepSeek_OCR_Setup.md
git add pdf_to_context/core/structure_preserver.py
git add pdf_to_context/models/data_models.py
git add pdf_to_context/extractors/native_extractor.py
git add pdf_to_context/extractors/ocr_client.py
git add pdf_to_context/ocr_service/app.py
git add pdf_to_context/pipeline.py
```

**Commit:**
```bash
git commit -m "feat: –ú–∏–≥—Ä–∞—Ü–∏—è –≤ Linux FS + –ø–æ–¥–¥–µ—Ä–∂–∫–∞ RTX 5080 + StructurePreserver

- –ü—Ä–æ–µ–∫—Ç –ø–µ—Ä–µ–Ω–µ—Å–µ–Ω –∏–∑ Windows FS –≤ Linux FS –¥–ª—è –º–∞–∫—Å–∏–º–∞–ª—å–Ω–æ–π –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏
- –£—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω PyTorch 2.9.0+cu128 —Å –ø–æ–¥–¥–µ—Ä–∂–∫–æ–π RTX 5080 (Blackwell, sm_120)
- –†–µ–∞–ª–∏–∑–æ–≤–∞–Ω StructurePreserver –¥–ª—è –≤—Å—Ç—Ä–∞–∏–≤–∞–Ω–∏—è OCR —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤ –≤ —Å—Ç—Ä—É–∫—Ç—É—Ä—É –¥–æ–∫—É–º–µ–Ω—Ç–∞
- –û–±–Ω–æ–≤–ª–µ–Ω FastAPI –º–∏–∫—Ä–æ—Å–µ—Ä–≤–∏—Å DeepSeek-OCR (–±–µ–∑ vLLM, —á–µ—Ä–µ–∑ HuggingFace API)
- –î–æ–±–∞–≤–ª–µ–Ω–∞ –ø–æ–¥–¥–µ—Ä–∂–∫–∞ —Ä–µ–Ω–¥–µ—Ä–∏–Ω–≥–∞ –≤–µ–∫—Ç–æ—Ä–Ω–æ–π –≥—Ä–∞—Ñ–∏–∫–∏ –¥–ª—è OCR
- –û–±–Ω–æ–≤–ª–µ–Ω–∞ –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è: –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏ –¥–ª—è Linux FS, PyTorch 2.9.0, RTX 5080
- –î–æ–±–∞–≤–ª–µ–Ω .gitignore –¥–ª—è –∏—Å–∫–ª—é—á–µ–Ω–∏—è –≤—Ä–µ–º–µ–Ω–Ω—ã—Ö —Ñ–∞–π–ª–æ–≤ –∏ venv"
```

**Push:**
```bash
git push origin main
```

**–†–µ–∑—É–ª—å—Ç–∞—Ç:**
```
To https://github.com/albud1978/Obligations.git
   6b32089..d03d265  main -> main
```

‚úÖ **–ò–∑–º–µ–Ω–µ–Ω–∏—è —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∏—Ä–æ–≤–∞–Ω—ã —Å GitHub!**

---

## üîß –¢–µ—Ö–Ω–∏—á–µ—Å–∫–∏–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è

### –ù–æ–≤—ã–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã

#### 1. `pdf_to_context/core/structure_preserver.py`
```python
class StructurePreserver:
    """
    –í—Å—Ç—Ä–∞–∏–≤–∞–µ—Ç OCR —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã –æ–±—Ä–∞—Ç–Ω–æ –≤ —Å—Ç—Ä—É–∫—Ç—É—Ä—É –¥–æ–∫—É–º–µ–Ω—Ç–∞
    –Ω–∞ –æ—Å–Ω–æ–≤–µ bounding box –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç.
    """
    def __init__(self, ocr_client: Optional[OCRClient] = None, 
                 min_area: float = 5000.0):
        self.ocr_client = ocr_client
        self.min_area = min_area
        self._stats = {
            "total_images": 0,
            "total_drawings": 0,
            "ocr_processed": 0,
            "ocr_skipped": 0,
            "ocr_errors": 0
        }
    
    def process_structure(self, blocks, page_num):
        # –°–æ—Ä—Ç–∏—Ä–æ–≤–∫–∞ –±–ª–æ–∫–æ–≤ –ø–æ –ø–æ–∑–∏—Ü–∏–∏ –Ω–∞ —Å—Ç—Ä–∞–Ω–∏—Ü–µ
        # –§–∏–ª—å—Ç—Ä–∞—Ü–∏—è –ø–æ min_area
        # OCR –¥–ª—è ImageBlock –∏ DrawingBlock —Å needs_ocr=True
        # –í–æ–∑–≤—Ä–∞—Ç –æ–±—Ä–∞–±–æ—Ç–∞–Ω–Ω—ã—Ö –±–ª–æ–∫–æ–≤
```

#### 2. –û–±–Ω–æ–≤–ª–µ–Ω–Ω—ã–π `pdf_to_context/ocr_service/app.py`
- FastAPI –º–∏–∫—Ä–æ—Å–µ—Ä–≤–∏—Å
- –ë–µ–∑ vLLM, –∏—Å–ø–æ–ª—å–∑—É–µ—Ç HuggingFace API
- Lazy loading –º–æ–¥–µ–ª–∏
- Endpoints: `/`, `/health`, `/ocr/figure`
- Structured output

### –ú–æ–¥–∏—Ñ–∏—Ü–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã

#### 1. `pdf_to_context/models/data_models.py`
–î–æ–±–∞–≤–ª–µ–Ω —Ñ–ª–∞–≥ `needs_ocr`:
```python
@dataclass
class ImageBlock:
    # ...
    needs_ocr: bool = False

@dataclass
class DrawingBlock:
    # ...
    image_data: Optional[bytes] = None
    needs_ocr: bool = False
```

#### 2. `pdf_to_context/extractors/native_extractor.py`
–î–æ–±–∞–≤–ª–µ–Ω —Ä–µ–Ω–¥–µ—Ä–∏–Ω–≥ –≤–µ–∫—Ç–æ—Ä–Ω–æ–π –≥—Ä–∞—Ñ–∏–∫–∏:
```python
def __init__(self, ..., render_vectors_to_image: bool = False, 
             vector_render_dpi: int = 300):
    self.render_vectors_to_image = render_vectors_to_image
    self.vector_render_dpi = vector_render_dpi

def extract_drawing_blocks(self, page, render_to_image=False, render_dpi=300):
    # –†–µ–Ω–¥–µ—Ä–∏–Ω–≥ –≤–µ–∫—Ç–æ—Ä–Ω—ã—Ö —ç–ª–µ–º–µ–Ω—Ç–æ–≤ –≤ PNG
    if render_to_image:
        image_data = self._render_region_to_image(page, bbox, dpi=render_dpi)
        needs_ocr = True if image_data else False
```

#### 3. `pdf_to_context/extractors/ocr_client.py`
–û–±–Ω–æ–≤–ª–µ–Ω –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å FastAPI:
```python
def ocr_image(self, image_data: bytes, page_num: int) -> Optional[OCRBlock]:
    # –û—Ç–ø—Ä–∞–≤–∫–∞ multipart/form-data
    files = {"file": ("image.png", image_data, "image/png")}
    response = requests.post(f"{self.base_url}/ocr/figure", files=files)
    # –ü–∞—Ä—Å–∏–Ω–≥ –Ω–æ–≤–æ–≥–æ —Ñ–æ—Ä–º–∞—Ç–∞ JSON
```

#### 4. `pdf_to_context/pipeline.py`
–ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è StructurePreserver:
```python
if self.enable_ocr and (page_data["image_blocks"] or page_data["drawing_blocks"]):
    structure_preserver = StructurePreserver(
        ocr_client=self.ocr_client,
        min_area=5000.0
    )
    all_blocks = page_data["text_blocks"] + page_data["image_blocks"] + \
                 page_data["drawing_blocks"] + page_data["table_blocks"]
    processed_blocks = structure_preserver.process_structure(all_blocks, page_num)
```

---

## üìö –û–±–Ω–æ–≤–ª–µ–Ω–Ω–∞—è –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è

### 1. `Changelog.md`
–î–æ–±–∞–≤–ª–µ–Ω—ã –∑–∞–ø–∏—Å–∏:
- **[29-10-2025] - –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∞ –Ω–µ—Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç—å RTX 5080 —Å PyTorch**
- **[29-10-2025] - –ü–µ—Ä–µ–Ω–æ—Å –ø—Ä–æ–µ–∫—Ç–∞ –≤ Linux FS –¥–ª—è –º–∞–∫—Å–∏–º–∞–ª—å–Ω–æ–π –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏**
- **[29-10-2025] - –†–µ–∞–ª–∏–∑–æ–≤–∞–Ω StructurePreserver**
- **[29-10-2025] - –î–æ–±–∞–≤–ª–µ–Ω–∞ –ø–æ–¥–¥–µ—Ä–∂–∫–∞ —Ä–µ–Ω–¥–µ—Ä–∏–Ω–≥–∞ –≤–µ–∫—Ç–æ—Ä–Ω–æ–π –≥—Ä–∞—Ñ–∏–∫–∏**
- **[29-10-2025] - –û—Ç–ª–∞–¥–∫–∞ DeepSeek-OCR –ø–æ–¥ HuggingFace API**

### 2. `docs/DeepSeek_OCR_Setup.md`
–û–±–Ω–æ–≤–ª–µ–Ω—ã —Ä–∞–∑–¥–µ–ª—ã:
- **–£—Å—Ç–∞–Ω–æ–≤–∫–∞ PyTorch:** —Ç–µ–ø–µ—Ä—å PyTorch 2.9.0+cu128 (–∫—Ä–∏—Ç–∏—á–Ω–æ –¥–ª—è RTX 5080!)
- **–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è Linux FS:** `~/Obligations` –≤–º–µ—Å—Ç–æ `/mnt/c/...`
- **–ü—Ä–æ–±–ª–µ–º–∞ 7:** –†–µ—à–µ–Ω–∏–µ RTX 5080 (Blackwell, sm_120) —Å PyTorch
- **–ü—Ä–æ–±–ª–µ–º–∞ 8:** –û—Ç–∫–∞–∑ –æ—Ç vLLM, –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ HuggingFace API

---

## ‚öôÔ∏è –¢–µ–∫—É—â–∞—è –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è

### –†–∞—Å–ø–æ–ª–æ–∂–µ–Ω–∏–µ –ø—Ä–æ–µ–∫—Ç–∞
```
Linux FS: /home/budnik_an/Obligations
Windows: \\wsl$\Ubuntu\home\budnik_an\Obligations
```

### –í–∏—Ä—Ç—É–∞–ª—å–Ω–æ–µ –æ–∫—Ä—É–∂–µ–Ω–∏–µ
```
~/Obligations/DeepSeek-OCR/venv
```

### –ö–ª—é—á–µ–≤—ã–µ –≤–µ—Ä—Å–∏–∏
```
Python: 3.10
PyTorch: 2.9.0+cu128
CUDA: 12.8
transformers: 4.46.3
tokenizers: 0.20.3
```

### GPU
```
NVIDIA GeForce RTX 5080
–ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞: Blackwell (sm_120)
VRAM: 16GB
```

### –ú–æ–¥–µ–ª—å DeepSeek-OCR
```
–ü—É—Ç—å –≤ –∫—ç—à–µ: ~/.cache/huggingface/hub/models--deepseek-ai--DeepSeek-OCR
–†–∞–∑–º–µ—Ä: ~14GB
```

---

## üîÑ –ó–∞–ø—É—Å–∫ —Å–∏—Å—Ç–µ–º—ã

### 1. –ó–∞–ø—É—Å–∫ OCR –º–∏–∫—Ä–æ—Å–µ—Ä–≤–∏—Å–∞
```bash
cd ~/Obligations
source DeepSeek-OCR/venv/bin/activate
python -m uvicorn pdf_to_context.ocr_service.app:app --host 0.0.0.0 --port 8000 --log-level info
```

### 2. –ü—Ä–æ–≤–µ—Ä–∫–∞ health check
```bash
curl http://localhost:8000/health | python3 -m json.tool
```

–û–∂–∏–¥–∞–µ–º—ã–π –æ—Ç–≤–µ—Ç:
```json
{
    "status": "healthy",
    "model_loaded": true,
    "cuda_available": true,
    "cuda_device": "NVIDIA GeForce RTX 5080"
}
```

### 3. –ó–∞–ø—É—Å–∫ –æ–±—Ä–∞–±–æ—Ç–∫–∏ PDF
```bash
cd ~/Obligations
source DeepSeek-OCR/venv/bin/activate
python test_vector_ocr_debug.py
```

---

## üêõ –ò–∑–≤–µ—Å—Ç–Ω—ã–µ –ø—Ä–æ–±–ª–µ–º—ã

### 1. –í–µ–∫—Ç–æ—Ä–Ω–∞—è –≥—Ä–∞—Ñ–∏–∫–∞ (BPMN –¥–∏–∞–≥—Ä–∞–º–º—ã) –Ω–µ —Ä–∞—Å–ø–æ–∑–Ω–∞–µ—Ç—Å—è

**–ü—Ä–æ–±–ª–µ–º–∞:**
–¢–µ–∫—Å—Ç –≤–Ω—É—Ç—Ä–∏ BPMN –¥–∏–∞–≥—Ä–∞–º–º (—ç–ª–µ–º–µ–Ω—Ç—ã –ø—Ä–æ—Ü–µ—Å—Å–æ–≤, —Å–æ–±—ã—Ç–∏—è, —à–ª—é–∑—ã) –Ω–µ –∏–∑–≤–ª–µ–∫–∞–µ—Ç—Å—è.

**–ü—Ä–∏—á–∏–Ω–∞:**
- –û—Ç–¥–µ–ª—å–Ω—ã–µ –≤–µ–∫—Ç–æ—Ä–Ω—ã–µ —ç–ª–µ–º–µ–Ω—Ç—ã —Å–ª–∏—à–∫–æ–º –º–∞–ª—ã (< 1000 px¬≤)
- –¢–µ–∫—Å—Ç —è–≤–ª—è–µ—Ç—Å—è —á–∞—Å—Ç—å—é native text layer –∏–ª–∏ –≤–µ–∫—Ç–æ—Ä–Ω—ã—Ö –ø—É—Ç–µ–π
- –¢–µ–∫—É—â–∏–π –ø–æ–¥—Ö–æ–¥: —Ä–µ–Ω–¥–µ—Ä–∏–Ω–≥ –æ—Ç–¥–µ–ª—å–Ω—ã—Ö —ç–ª–µ–º–µ–Ω—Ç–æ–≤ - –Ω–µ —Ä–∞–±–æ—Ç–∞–µ—Ç

**–ü—Ä–µ–¥–ª–æ–∂–µ–Ω–Ω–æ–µ —Ä–µ—à–µ–Ω–∏–µ:**
**–ü–æ–¥—Ö–æ–¥ B: –†–µ–Ω–¥–µ—Ä–∏–Ω–≥ —Ü–µ–ª—ã—Ö —Å—Ç—Ä–∞–Ω–∏—Ü —Å –¥–∏–∞–≥—Ä–∞–º–º–∞–º–∏**
1. –î–µ—Ç–µ–∫—Ç–∏—Ä–æ–≤–∞—Ç—å —Å—Ç—Ä–∞–Ω–∏—Ü—ã —Å –±–æ–ª—å—à–∏–º –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ–º –≤–µ–∫—Ç–æ—Ä–Ω—ã—Ö —ç–ª–µ–º–µ–Ω—Ç–æ–≤
2. –†–µ–Ω–¥–µ—Ä–∏—Ç—å –≤—Å—é —Å—Ç—Ä–∞–Ω–∏—Ü—É –≤ —Ä–∞—Å—Ç—Ä–æ–≤–æ–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ (DPI 300)
3. –û—Ç–ø—Ä–∞–≤–∏—Ç—å –≤ DeepSeek-OCR –¥–ª—è —Ä–∞—Å–ø–æ–∑–Ω–∞–≤–∞–Ω–∏—è —Å—Ç—Ä—É–∫—Ç—É—Ä—ã
4. –ò–∑–≤–ª–µ—á—å —Ç–µ–∫—Å—Ç –∏–∑ —Ñ–∏–≥—É—Ä –¥–∏–∞–≥—Ä–∞–º–º—ã

**–°—Ç–∞—Ç—É—Å:** –ù–µ —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–æ. –û–∂–∏–¥–∞–µ—Ç —Å–æ–≥–ª–∞—Å–æ–≤–∞–Ω–∏—è.

### 2. Warnings –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ –º–æ–¥–µ–ª–∏

**–í—ã–≤–æ–¥:**
```
You are using a model of type deepseek_vl_v2 to instantiate a model of type DeepseekOCR. This is not supported for all configurations of models and can yield errors.
Some weights of DeepseekOCRForCausalLM were not initialized from the model checkpoint at deepseek-ai/DeepSeek-OCR and are newly initialized: ['model.vision_model.embeddings.position_ids']
You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.
```

**–°—Ç–∞—Ç—É—Å:** –ú–æ–∂–Ω–æ –∏–≥–Ω–æ—Ä–∏—Ä–æ–≤–∞—Ç—å. –ú–æ–¥–µ–ª—å —Ä–∞–±–æ—Ç–∞–µ—Ç –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ –¥–ª—è inference.

---

## üìä –°–ª–µ–¥—É—é—â–∏–µ —à–∞–≥–∏

### –í–∞—Ä–∏–∞–Ω—Ç 1: –†–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å —Ä–∞—Å–ø–æ–∑–Ω–∞–≤–∞–Ω–∏–µ BPMN –¥–∏–∞–≥—Ä–∞–º–º
**–ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç:** –í—ã—Å–æ–∫–∏–π

**–ó–∞–¥–∞—á–∏:**
1. –î–µ—Ç–µ–∫—Ü–∏—è —Å—Ç—Ä–∞–Ω–∏—Ü —Å –¥–∏–∞–≥—Ä–∞–º–º–∞–º–∏ (–ø–æ –∫–æ–ª–∏—á–µ—Å—Ç–≤—É –≤–µ–∫—Ç–æ—Ä–Ω—ã—Ö —ç–ª–µ–º–µ–Ω—Ç–æ–≤)
2. –†–µ–Ω–¥–µ—Ä–∏–Ω–≥ —Ü–µ–ª—ã—Ö —Å—Ç—Ä–∞–Ω–∏—Ü –≤ —Ä–∞—Å—Ç—Ä (300 DPI)
3. OCR —á–µ—Ä–µ–∑ DeepSeek-OCR
4. –ü–∞—Ä—Å–∏–Ω–≥ —Å—Ç—Ä—É–∫—Ç—É—Ä—ã –¥–∏–∞–≥—Ä–∞–º–º—ã –∏–∑ OCR —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞
5. –ó–∞–º–µ–Ω–∞ placeholder'–æ–≤ –Ω–∞ —Ä–∞—Å–ø–æ–∑–Ω–∞–Ω–Ω—ã–π —Ç–µ–∫—Å—Ç

**–û—Ü–µ–Ω–∫–∞:** 2-3 —á–∞—Å–∞ —Ä–∞–±–æ—Ç—ã

### –í–∞—Ä–∏–∞–Ω—Ç 2: –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏
**–ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç:** –°—Ä–µ–¥–Ω–∏–π

**–ó–∞–¥–∞—á–∏:**
1. Batch processing –¥–ª—è OCR (–Ω–µ—Å–∫–æ–ª—å–∫–æ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π –∑–∞ —Ä–∞–∑)
2. –ö—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ OCR —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤
3. –ü–∞—Ä–∞–ª–ª–µ–ª—å–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ —Å—Ç—Ä–∞–Ω–∏—Ü
4. –ü—Ä–æ—Ñ–∏–ª–∏—Ä–æ–≤–∞–Ω–∏–µ bottlenecks

**–û—Ü–µ–Ω–∫–∞:** 3-4 —á–∞—Å–∞ —Ä–∞–±–æ—Ç—ã

### –í–∞—Ä–∏–∞–Ω—Ç 3: –£–ª—É—á—à–µ–Ω–∏–µ –∏–∑–≤–ª–µ—á–µ–Ω–∏—è —Å—Ç—Ä—É–∫—Ç—É—Ä—ã
**–ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç:** –°—Ä–µ–¥–Ω–∏–π

**–ó–∞–¥–∞—á–∏:**
1. –£–ª—É—á—à–µ–Ω–∏–µ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è –∑–∞–≥–æ–ª–æ–≤–∫–æ–≤ (—É—á–µ—Ç —à—Ä–∏—Ñ—Ç–æ–≤, —Ä–∞–∑–º–µ—Ä–æ–≤)
2. –õ—É—á—à–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ —Ç–∞–±–ª–∏—Ü (–æ–±—ä–µ–¥–∏–Ω–µ–Ω–∏–µ —Ä–∞–∑–±–∏—Ç—ã—Ö —Ç–∞–±–ª–∏—Ü)
3. –î–µ—Ç–µ–∫—Ü–∏—è —Å–ø–∏—Å–∫–æ–≤ (–Ω—É–º–µ—Ä–æ–≤–∞–Ω–Ω—ã–µ, –º–∞—Ä–∫–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ)
4. –ò–∑–≤–ª–µ—á–µ–Ω–∏–µ –º–µ—Ç–∞–¥–∞–Ω–Ω—ã—Ö –¥–æ–∫—É–º–µ–Ω—Ç–∞

**–û—Ü–µ–Ω–∫–∞:** 4-5 —á–∞—Å–æ–≤ —Ä–∞–±–æ—Ç—ã

### –í–∞—Ä–∏–∞–Ω—Ç 4: –£–¥–∞–ª–µ–Ω–∏–µ —Å—Ç–∞—Ä–æ–π Windows FS –≤–µ—Ä—Å–∏–∏
**–ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç:** –ù–∏–∑–∫–∏–π

**–ó–∞–¥–∞—á–∞:**
–û—Å–≤–æ–±–æ–¥–∏—Ç—å 5-10 GB –º–µ—Å—Ç–∞ –Ω–∞ –¥–∏—Å–∫–µ C:

```bash
rm -rf /mnt/c/Users/Budnik_AN/Obligations
```

**–°—Ç–∞—Ç—É—Å:** –û–∂–∏–¥–∞–µ—Ç –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è.

---

## üîó –ü–æ–ª–µ–∑–Ω—ã–µ —Å—Å—ã–ª–∫–∏

### GitHub
- **–†–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π:** https://github.com/albud1978/Obligations.git
- **–ü–æ—Å–ª–µ–¥–Ω–∏–π commit:** d03d265 (29.10.2025)

### –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è
- `README.md` - –æ–±—â–µ–µ –æ–ø–∏—Å–∞–Ω–∏–µ –ø—Ä–æ–µ–∫—Ç–∞
- `docs/Architecture.md` - —Ç–µ—Ö–Ω–∏—á–µ—Å–∫–∞—è –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞
- `docs/DeepSeek_OCR_Setup.md` - –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏ –ø–æ —É—Å—Ç–∞–Ω–æ–≤–∫–µ DeepSeek-OCR
- `Changelog.md` - –∏—Å—Ç–æ—Ä–∏—è –∏–∑–º–µ–Ω–µ–Ω–∏–π

### DeepSeek-OCR
- **GitHub:** https://github.com/deepseek-ai/DeepSeek-OCR
- **HuggingFace Model:** https://huggingface.co/deepseek-ai/DeepSeek-OCR
- **Paper:** https://arxiv.org/abs/2409.12014

### PyTorch & CUDA
- **PyTorch:** https://pytorch.org/
- **CUDA for WSL:** https://docs.nvidia.com/cuda/wsl-user-guide/
- **RTX 5080 support:** https://discuss.pytorch.org/t/compatibility-of-pytorch-with-rtx-5080/221626

---

## üìù –ó–∞–º–µ—Ç–∫–∏ –∏ —É—Ä–æ–∫–∏

### 1. RTX 5080 (Blackwell) —Ç—Ä–µ–±—É–µ—Ç PyTorch 2.9.0+
**–ö—Ä–∏—Ç–∏—á–Ω–æ!** –ù–µ —Ä–∞–±–æ—Ç–∞–µ—Ç —Å PyTorch 2.7.x –∏ —Å—Ç–∞—Ä—à–µ –∏–∑-–∑–∞ –æ—Ç—Å—É—Ç—Å—Ç–≤–∏—è –ø–æ–¥–¥–µ—Ä–∂–∫–∏ sm_120.

### 2. Linux FS –∑–Ω–∞—á–∏—Ç–µ–ª—å–Ω–æ –±—ã—Å—Ç—Ä–µ–µ Windows FS –≤ WSL
–ú–∏–≥—Ä–∞—Ü–∏—è –≤ `~/` –¥–∞–ª–∞ –ø—Ä–∏—Ä–æ—Å—Ç –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏ –≤ 2-5 —Ä–∞–∑ –¥–ª—è I/O –æ–ø–µ—Ä–∞—Ü–∏–π.

### 3. vLLM - –∏–∑–±—ã—Ç–æ—á–Ω–∞—è —Å–ª–æ–∂–Ω–æ—Å—Ç—å
–û—Ç–∫–∞–∑ –æ—Ç vLLM —É–ø—Ä–æ—Å—Ç–∏–ª –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—É –∏ —É—Å—Ç—Ä–∞–Ω–∏–ª –º–Ω–æ–∂–µ—Å—Ç–≤–æ –ø—Ä–æ–±–ª–µ–º —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç–∏.

### 4. –í–µ–∫—Ç–æ—Ä–Ω–∞—è –≥—Ä–∞—Ñ–∏–∫–∞ —Ç—Ä–µ–±—É–µ—Ç —Å–ø–µ—Ü–∏–∞–ª—å–Ω–æ–≥–æ –ø–æ–¥—Ö–æ–¥–∞
–†–µ–Ω–¥–µ—Ä–∏–Ω–≥ –æ—Ç–¥–µ–ª—å–Ω—ã—Ö —ç–ª–µ–º–µ–Ω—Ç–æ–≤ –Ω–µ —Ä–∞–±–æ—Ç–∞–µ—Ç. –ù—É–∂–Ω–æ —Ä–µ–Ω–¥–µ—Ä–∏—Ç—å —Ü–µ–ª—ã–µ –æ–±–ª–∞—Å—Ç–∏/—Å—Ç—Ä–∞–Ω–∏—Ü—ã.

### 5. –í–µ—Ä—Å–∏–∏ transformers –∏ tokenizers –∫—Ä–∏—Ç–∏—á–Ω—ã
–ù–µ—Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç—å –≤–µ—Ä—Å–∏–π –º–æ–∂–µ—Ç –ø—Ä–∏–≤–µ—Å—Ç–∏ –∫ cryptic –æ—à–∏–±–∫–∞–º –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ –º–æ–¥–µ–ª–∏.

---

## üéØ –¢–µ–∫—É—â–∏–π —Ñ–æ–∫—É—Å

**–ó–∞–¥–∞—á–∞:** –†–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å —Ä–∞—Å–ø–æ–∑–Ω–∞–≤–∞–Ω–∏–µ —Ç–µ–∫—Å—Ç–∞ –≤–Ω—É—Ç—Ä–∏ BPMN –¥–∏–∞–≥—Ä–∞–º–º.

**–ü–æ–¥—Ö–æ–¥:** –†–µ–Ω–¥–µ—Ä–∏–Ω–≥ —Ü–µ–ª—ã—Ö —Å—Ç—Ä–∞–Ω–∏—Ü —Å –¥–∏–∞–≥—Ä–∞–º–º–∞–º–∏ ‚Üí OCR ‚Üí –∏–∑–≤–ª–µ—á–µ–Ω–∏–µ —Å—Ç—Ä—É–∫—Ç—É—Ä—ã.

**–°—Ç–∞—Ç—É—Å:** –û–∂–∏–¥–∞–µ—Ç —Ä–µ—à–µ–Ω–∏—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –æ –Ω–∞—á–∞–ª–µ —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏.

---

## üíæ –ë—ç–∫–∞–ø –∏ –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ

### –°–æ–∑–¥–∞–Ω–∏–µ –±—ç–∫–∞–ø–∞
```bash
cd ~
tar -czf Obligations_backup_$(date +%Y%m%d_%H%M%S).tar.gz Obligations/ \
  --exclude='Obligations/DeepSeek-OCR/venv' \
  --exclude='Obligations/output' \
  --exclude='Obligations/__pycache__'
```

### –í–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ
```bash
cd ~
tar -xzf Obligations_backup_YYYYMMDD_HHMMSS.tar.gz

# –ü–µ—Ä–µ—Å–æ–∑–¥–∞—Ç—å venv
cd Obligations/DeepSeek-OCR
python3 -m venv venv
source venv/bin/activate
pip install torch torchvision torchaudio --index-url https://download.pytorch.org/whl/cu128
pip install -r requirements.txt
```

---

**–î–∞—Ç–∞ —Å–æ–∑–¥–∞–Ω–∏—è:** 29 –æ–∫—Ç—è–±—Ä—è 2025, 17:45  
**–ê–≤—Ç–æ—Ä:** Cursor AI + User  
**–í–µ—Ä—Å–∏—è:** 1.0

