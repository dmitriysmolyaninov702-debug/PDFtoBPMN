# –ò—Å—Å–ª–µ–¥–æ–≤–∞–Ω–∏–µ vLLM –¥–ª—è DeepSeek-OCR –Ω–∞ RTX 5080

**–î–∞—Ç–∞:** 07.11.2024  
**–¶–µ–ª—å:** –ü—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å vLLM –¥–ª—è —É—Å–∫–æ—Ä–µ–Ω–∏—è –∏–Ω—Ñ–µ—Ä–µ–Ω—Å–∞ DeepSeek-OCR –Ω–∞ RTX 5080 (Blackwell, sm_120)

---

## ‚ùå –†–ï–ó–£–õ–¨–¢–ê–¢: vLLM –ù–ï –†–ê–ë–û–¢–ê–ï–¢

### –ü—Ä–∏—á–∏–Ω—ã –Ω–µ—Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç–∏

#### –ü—Ä–æ–±–ª–µ–º–∞ 1: PyTorch 2.6.0 –Ω–µ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç RTX 5080
- **vLLM 0.8.5** (—Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è –≤ –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏–∏ DeepSeek-OCR) —Ç—Ä–µ–±—É–µ—Ç PyTorch 2.6.0
- **PyTorch 2.6.0** –Ω–µ –∏–º–µ–µ—Ç CUDA —è–¥–µ—Ä –¥–ª—è –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—ã sm_120 (RTX 5080 Blackwell)
- **–û—à–∏–±–∫–∞:** `CUDA error: no kernel image is available for execution on the device`
- **–¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–æ:** PyTorch 2.6.0+cu118, PyTorch 2.6.0+cu124 - –æ–±–∞ –ù–ï —Ä–∞–±–æ—Ç–∞—é—Ç

#### –ü—Ä–æ–±–ª–µ–º–∞ 2: ABI –Ω–µ—Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç—å
- –ü–æ–ø—ã—Ç–∫–∞ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å **vLLM 0.8.5 —Å PyTorch 2.7.0+** –ø—Ä–∏–≤–æ–¥–∏—Ç –∫ –æ—à–∏–±–∫–µ:
  ```
  ImportError: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSsb
  ```
- vLLM 0.8.5 —Å–∫–æ–º–ø–∏–ª–∏—Ä–æ–≤–∞–Ω –ø–æ–¥ PyTorch 2.6.0 –∏ –Ω–µ –º–æ–∂–µ—Ç —Ä–∞–±–æ—Ç–∞—Ç—å —Å –±–æ–ª–µ–µ –Ω–æ–≤—ã–º–∏ –≤–µ—Ä—Å–∏—è–º–∏

#### –ü—Ä–æ–±–ª–µ–º–∞ 3: vLLM 0.11.0 –Ω–µ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç DeepSeek-OCR
- **vLLM 0.11.0** (upstream nightly) —Ä–∞–±–æ—Ç–∞–µ—Ç —Å PyTorch 2.8.0+ –∏ RTX 5080
- –ù–û: –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ `DeepseekOCRForCausalLM` –æ—Ç—Å—É—Ç—Å—Ç–≤—É–µ—Ç –≤ —Å–ø–∏—Å–∫–µ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ–º—ã—Ö –º–æ–¥–µ–ª–µ–π
- **–û—à–∏–±–∫–∞:** `Model architectures ['DeepseekOCRForCausalLM'] are not supported`

---

## ‚úÖ –†–ê–ë–û–ß–ï–ï –†–ï–®–ï–ù–ò–ï

**–û–∫—Ä—É–∂–µ–Ω–∏–µ:** `/home/budnik_an/Obligations/DeepSeek-OCR/venv`

**–ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è:**
- PyTorch 2.9.0+cu128
- flash-attn 2.7.3
- transformers 4.57.1
- CUDA 12.8

**–ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å:**
- –°—Ç—Ä–∞–Ω–∏—Ü–∞ 23 (BPMN –¥–∏–∞–≥—Ä–∞–º–º–∞): ~3-5 —Å–µ–∫—É–Ω–¥
- GPU: RTX 5080 16GB
- –†–µ–∂–∏–º: Transformers API —Å flash attention

---

## üìä –ü–û–ü–´–¢–ö–ò –†–ï–®–ï–ù–ò–Ø

| –ü–æ–ø—ã—Ç–∫–∞ | PyTorch | vLLM | RTX 5080 | DeepSeek-OCR | –†–µ–∑—É–ª—å—Ç–∞—Ç |
|---------|---------|------|----------|--------------|-----------|
| 1 | 2.6.0+cu118 | 0.8.5 | ‚ùå | ‚úÖ | CUDA error |
| 2 | 2.6.0+cu124 | 0.8.5 | ‚ùå | ‚úÖ | CUDA error |
| 3 | 2.7.0+cu128 | 0.8.5 | ‚úÖ | ‚úÖ | ABI error |
| 4 | 2.8.0+cu128 | 0.11.0 | ‚úÖ | ‚ùå | Model not supported |
| 5 | 2.9.0+cu128 | Transformers | ‚úÖ | ‚úÖ | ‚úÖ **–†–ê–ë–û–¢–ê–ï–¢** |

---

## üîç –í–´–í–û–î–´

1. **RTX 5080 (Blackwell)** —Ç—Ä–µ–±—É–µ—Ç PyTorch 2.7+ —Å CUDA 12.8
2. **vLLM 0.8.5** —Ñ–∏–∑–∏—á–µ—Å–∫–∏ –Ω–µ –º–æ–∂–µ—Ç —Ä–∞–±–æ—Ç–∞—Ç—å –Ω–∞ RTX 5080 –∏–∑-–∑–∞ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –æ—Ç PyTorch 2.6.0
3. **vLLM 0.11.0+** –Ω–µ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç DeepSeek-OCR –º–æ–¥–µ–ª—å
4. **Transformers API** - –µ–¥–∏–Ω—Å—Ç–≤–µ–Ω–Ω–æ–µ —Ä–∞–±–æ—á–µ–µ —Ä–µ—à–µ–Ω–∏–µ –¥–ª—è RTX 5080

---

## üìÅ –°–û–î–ï–†–ñ–ò–ú–û–ï –ê–†–•–ò–í–ê

- `test_vllm_page23.py` - –∞–¥–∞–ø—Ç–∏—Ä–æ–≤–∞–Ω–Ω—ã–π —Å–∫—Ä–∏–ø—Ç –¥–ª—è vLLM 0.11.0
- `test_vllm_page_23.py` - –æ—Ä–∏–≥–∏–Ω–∞–ª—å–Ω—ã–π —Å–∫—Ä–∏–ø—Ç –¥–ª—è vLLM 0.8.5
- `vllm_test/` - —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è
  - `page_23.png` - —Ç–µ—Å—Ç–æ–≤–æ–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ (—Å—Ç—Ä–∞–Ω–∏—Ü–∞ 23 –∏–∑ –î–ü-–ú1.020-06)
  - `page_23_test.png` - –∞–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–Ω–æ–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ
  - `transformers_result.txt` - —Ä–µ–∑—É–ª—å—Ç–∞—Ç Transformers API (—Ä–∞–±–æ—Ç–∞–µ—Ç)

---

## üí° –†–ï–ö–û–ú–ï–ù–î–ê–¶–ò–ò

**–ü—Ä–æ–¥–æ–ª–∂–∞—Ç—å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å Transformers API** –≤ –æ—Å–Ω–æ–≤–Ω–æ–º –æ–∫—Ä—É–∂–µ–Ω–∏–∏:
```bash
source /home/budnik_an/Obligations/DeepSeek-OCR/venv/bin/activate
```

**–ü—Ä–∏—á–∏–Ω—ã:**
- ‚úÖ –°—Ç–∞–±–∏–ª—å–Ω–æ —Ä–∞–±–æ—Ç–∞–µ—Ç —Å RTX 5080
- ‚úÖ –ü–æ–¥–¥–µ—Ä–∂–∫–∞ flash attention –¥–ª—è —É—Å–∫–æ—Ä–µ–Ω–∏—è
- ‚úÖ –ü–æ–ª–Ω–∞—è —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç—å —Å DeepSeek-OCR
- ‚úÖ –î–æ—Å—Ç–∞—Ç–æ—á–Ω–∞—è –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å (~3-5 —Å–µ–∫/—Å—Ç—Ä–∞–Ω–∏—Ü–∞)

**vLLM –º–æ–∂–Ω–æ –±—É–¥–µ—Ç –ø–æ–ø—Ä–æ–±–æ–≤–∞—Ç—å –∫–æ–≥–¥–∞:**
- –ü–æ—è–≤–∏—Ç—Å—è –ø–æ–¥–¥–µ—Ä–∂–∫–∞ RTX 5080 –≤ PyTorch 2.6.0 (–º–∞–ª–æ–≤–µ—Ä–æ—è—Ç–Ω–æ)
- –ò–õ–ò vLLM –¥–æ–±–∞–≤–∏—Ç –ø–æ–¥–¥–µ—Ä–∂–∫—É DeepseekOCRForCausalLM –≤ upstream –≤–µ—Ä—Å–∏–∏
- –ò–õ–ò –≤—ã–π–¥–µ—Ç vLLM –≤–µ—Ä—Å–∏—è, —Å–æ–≤–º–µ—Å—Ç–∏–º–∞—è —Å PyTorch 2.7+

---

**–ê—Ä—Ö–∏–≤–∏—Ä–æ–≤–∞–Ω–æ:** 07.11.2024  
**–†–∞–∑–º–µ—Ä –æ—Å–≤–æ–±–æ–∂–¥–µ–Ω–Ω–æ–≥–æ –º–µ—Å—Ç–∞:** 11GB (—É–¥–∞–ª–µ–Ω–æ –æ–∫—Ä—É–∂–µ–Ω–∏–µ venv_vllm)

